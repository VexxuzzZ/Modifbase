<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VexxNever - Login</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <style>
    <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }body {
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: radial-gradient(circle at center, #14001f, #050008, #000);
  overflow: hidden;
  font-family: 'Poppins', sans-serif;
}

/* Neon Purple Stars Background */
.star {
  position: absolute;
  width: 3px;
  height: 3px;
  background: #c000ff;
  border-radius: 50%;
  box-shadow: 0 0 8px #c000ff;
  animation: twinkle 3s infinite ease-in-out;
}

@keyframes twinkle {
  0% { opacity: 0.3; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.7); }
  100% { opacity: 0.3; transform: scale(1); }
}

/* Card Container */
.card-loading {
  width: 360px;
  padding: 25px;
  border-radius: 18px;
  background: rgba(25, 0, 40, 0.65);
  backdrop-filter: blur(12px);
  box-shadow: 0 0 30px rgba(170, 0, 255, 0.4);
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.08);
  opacity: 0;
  transform: translateY(30px);
  animation: cardIn 1s ease forwards;
  z-index: 10;
}

@keyframes cardIn {
  to { opacity: 1; transform: translateY(0); }
}

/* Title */
.title {
  font-size: 2rem;
  font-weight: 700;
  letter-spacing: 2px;
  background: linear-gradient(90deg, #d000ff, #8000ff, #d000ff);
  background-size: 300%;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: neonGlow 4s infinite linear;
  margin-bottom: 20px;
}

@keyframes neonGlow {
  0% { background-position: 0%; }
  50% { background-position: 200%; }
  100% { background-position: 0%; }
}

/* MP4 Card Player */
.video-wrapper {
  width: 100%;
  border-radius: 12px;
  overflow: hidden;
  margin-bottom: 18px;
  box-shadow: 0 0 20px rgba(195, 0, 255, 0.5);
  border: 2px solid #A63BFF;
}

.video-player {
  width: 100%;
  height: auto;
  display: block;
}

/* Progress Bar */
.progress-container {
  width: 100%;
  height: 10px;
  background: rgba(255, 255, 255, 0.15);
  border-radius: 10px;
  overflow: hidden;
  margin-top: 18px;
}

.progress-bar {
  width: 0%;
  height: 100%;
  background: linear-gradient(90deg, #d200ff, #7a00ff);
  box-shadow: 0 0 10px #d200ff;
  transition: width 0.2s linear;
}

.percent-text {
  margin-top: 8px;
  font-size: 1rem;
  color: #fff;
  letter-spacing: 1px;
  text-shadow: 0 0 5px #c000ff;
}
  
  :root {
    --bg:#000000;
    --card:#0f0f0f;
    --muted:#888888;
    --text:#ffffff;
    --primary:#000000;
    --secondary:#111111;
    --accent:#222222;
  }

  *{box-sizing:border-box;margin:0;padding:0;}

  body {
    font-family:Poppins, sans-serif;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background: radial-gradient(circle at 20% 20%, rgba(255,255,255,.05), transparent 30%),
                radial-gradient(circle at 80% 10%, rgba(255,255,255,.04), transparent 25%),
                radial-gradient(circle at 50% 90%, rgba(255,255,255,.03), transparent 30%),
                var(--bg);
    overflow:hidden;
    padding:20px;
  }

  .card {
    background: rgba(255,255,255,.05);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255,255,255,.08);
    border-radius: 20px;
    padding: 30px 25px;
    width: 100%;
    max-width: 380px;
    text-align: center;
    box-shadow:0 0 30px rgba(255,255,255,.05);
    animation: fadeIn 0.8s ease;
    position: relative;
    overflow: hidden;
  }

  .card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, #000000, #222222);
    border-radius: 20px 20px 0 0;
  }

  @keyframes fadeIn {
    from { opacity:0; transform:translateY(25px) scale(0.95); }
    to   { opacity:1; transform:translateY(0) scale(1); }
  }

  .logo-container {
    position: relative;
    width: 100px;
    height: 100px;
    margin: 0 auto 15px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .logo-ring {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background: conic-gradient(
      #333333 0%, 
      #111111 30%, 
      #000000 60%, 
      #333333 100%
    );
    animation: rotate 3s linear infinite;
    padding: 4px;
  }

  .logo {
    width: 92px;
    height: 92px;
    border-radius: 50%;
    object-fit: cover;
    display: block;
    z-index: 1;
    position: relative;
    background: #1a1a1a;
    border: 2px solid rgba(255,255,255,0.05);
  }

  @keyframes rotate {
    0% { transform: rotate(0deg);}
    100% { transform: rotate(360deg);}
  }

  .title {
    font-size:26px;
    font-family:Orbitron, sans-serif;
    font-weight:800;
    color: var(--text);
    margin-bottom:6px;
    text-shadow:0 0 10px rgba(255,255,255,.2);
    letter-spacing: 1px;
  }

  .subtitle {
    font-size:13px;
    color: var(--muted);
    margin-bottom:25px;
    font-weight:400;
    letter-spacing: 0.5px;
  }

  .form-group {
    position:relative;
    margin-bottom:18px;
  }

  .form-group i {
    position:absolute;
    left:15px;
    top:50%;
    transform:translateY(-50%);
    color:#444444;
    font-size:16px;
    z-index: 2;
  }

  input {
    width:100%;
    padding:15px 15px 15px 45px;
    border-radius:12px;
    border:1px solid rgba(255,255,255,.1);
    background:rgba(255,255,255,.06);
    color:var(--text);
    font-size:14px;
    outline:none;
    transition: all .3s ease;
    backdrop-filter: blur(10px);
    font-weight:500;
  }

  input:focus {
    border-color:#333;
    box-shadow:0 0 0 2px rgba(255,255,255,.15);
    background:rgba(255,255,255,.12);
    transform: translateY(-2px);
  }

  input::placeholder {
    color: var(--muted);
    font-weight:400;
  }

  button {
    width:100%;
    padding:16px;
    font-size:15px;
    font-weight:600;
    border:none;
    border-radius:12px;
    cursor:pointer;
    background:linear-gradient(135deg, #000000, #222222);
    color:white;
    transition: all .4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow:0 0 15px rgba(255,255,255,.1);
    margin-top: 10px;
    letter-spacing: 0.5px;
  }

  button:hover {
    transform:translateY(-4px) scale(1.02);
    box-shadow:0 0 20px rgba(255,255,255,.15);
  }

  .buy-access {
    margin-top:20px;
    display:inline-block;
    font-size:13px;
    padding:12px 20px;
    border-radius:12px;
    font-weight:500;
    background:linear-gradient(135deg, #1a1a1a, #333333);
    color:white;
    text-decoration:none;
    box-shadow:0 0 15px rgba(255,255,255,.1);
    backdrop-filter: blur(10px);
    border:1px solid rgba(255,255,255,.1);
  }

  .buy-access:hover { 
    transform:translateY(-3px) scale(1.05);
    box-shadow:0 0 25px rgba(255,255,255,.15);
  }

  .footer {
    margin-top:25px;
    font-size:11px;
    color:var(--muted);
    opacity: 0.8;
  }

  .toast {
    position:fixed;
    bottom:40px;
    left:50%;
    transform:translateX(-50%);
    background: linear-gradient(135deg, #000000, #222222);
    color:white;
    padding:12px 20px;
    border-radius:10px;
    font-size:13px;
    font-weight:500;
    box-shadow:0 0 20px rgba(255,255,255,.15);
    opacity:0;
    animation: fadeInOut 4s ease forwards;
    z-index:100;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,.1);
  }

  @keyframes fadeInOut {
    0%{opacity:0; transform:translate(-50%,30px);}
    15%{opacity:1; transform:translate(-50%,0);}
    85%{opacity:1; transform:translate(-50%,0);}
    100%{opacity:0; transform:translate(-50%,30px);}
  }
  
    /* Particle background effect */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }
    
    .particle {
      position: absolute;
      background: var(--primary);
      border-radius: 50%;
      opacity: 0.3;
      animation: float 6s infinite ease-in-out;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(180deg); }
    }
</style>
</head>
<body>
<div id="particles" class="particles"></div>


 <!-- Stars Background -->  <script>
    for (let i = 0; i < 90; i++) {
      const s = document.createElement('div');
      s.classList.add('star');
      s.style.left = Math.random() * window.innerWidth + 'px';
      s.style.top = Math.random() * window.innerHeight + 'px';
      s.style.animationDelay = (Math.random() * 4) + 's';
      document.body.appendChild(s);
    }
  </script> 
   <!-- Card Loader with MP4 inside -->  

  <div class="card" id="login-screen" style="display:none;">
    <div class="logo-container">
      <div class="logo-ring"></div>
      <video class="logo" autoplay loop muted playsinline>
        <source src="https://files.catbox.moe/oszem2.mov" type="video/mp4">
      </video>
    </div>
    
    <div class="title">„Ç∏„É•„É≠„ÉÉ„ÇØ„ÇπZ „Éç„Éê„Éº„ÉÄ„Ç§</div>
    <div class="subtitle"><pre>„Ç∑„Çπ„ÉÜ„É†„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà API „Å∏„ÅÆ„Ç≤„Éº„Éà„Ç¶„Çß„Ç§</pre></div>

    <form method="POST" action="/auth">
      <div class="form-group">
        <i class="fas fa-user"></i>
        <input type="text" name="username" placeholder="Username" required />
      </div>
      <div class="form-group">
        <i class="fas fa-key"></i>
        <input type="password" name="key" placeholder="Password" required />
      </div>
      <button type="submit">
        <i class="fa-solid fa-right-to-bracket"></i> „É≠„Ç∞„Ç§„É≥
      </button>
    </form>

    <a class="buy-access" href="https://t.me/Axelnotdev" target="_blank">
      <i class="fas fa-coins"></i> „Ç≠„Éº„Ç¢„ÇØ„Çª„Çπ„ÇíÂèñÂæó
    </a>

    <div class="footer">¬© 2025 - VexxNever | „Çª„Ç≠„É•„Ç¢„Ç∑„Çπ„ÉÜ„É†„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ</div>
  </div>

  <div id="toast" class="toast" style="display:none;"></div>
  
 <div class="card-loading" id="loading-screen"><div class="title">VexxNever</div>

  <div class="video-wrapper">
    <video class="video-player" autoplay loop muted>
      <source src="https://files.catbox.moe/mksc7a.mp4" type="video/mp4">
    </video>
  </div>

  <div class="progress-container">
      <div class="progress-bar" id="progress-bar"></div>
  </div>

  <div class="percent-text" id="percent-text">0%</div>

  </div>  
  
  <script>
          // --- PENGATURAN GITLAB ---
const GITLAB_TOKEN = 'glpat-TnCSsGUvt2mdno-csDaLc286MQp1Oml0aTBpCw.01.121kckuya';
        const GITLAB_PROJECT_ID = '76072810';
        const GITLAB_BRANCH = 'main';

const USERS_FILE = 'users.json';
const GITLAB_BASE_URL = `https://gitlab.com/api/v4/projects/${GITLAB_PROJECT_ID}/repository/files/`;
const GITLAB_USERS_URL = `${GITLAB_BASE_URL}${encodeURIComponent(USERS_FILE)}`;

// --- ELEMEN DOM ---
const loginPage = document.getElementById('login-page');
const loginForm = document.getElementById('login-form');
const loginButton = document.getElementById('login-button');

// --- UTILITAS ---
function showNotification(id, message, type) {
    const el = document.getElementById(id);
    if (!el) return;
    el.textContent = message;
    el.className = 'notification ' + type;
    el.style.display = 'block';
}
function hideAllNotifications() {
    document.querySelectorAll('.notification').forEach(el => el.style.display = 'none');
}
function disableButton(btn) {
    if (!btn) return;
    btn.disabled = true;
    btn.setAttribute('data-original-text', btn.textContent);
    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
}
function enableButton(btn, text) {
    if (!btn) return;
    const originalText = btn.getAttribute('data-original-text');
    if (text) {
        if (text.startsWith('<i')) btn.innerHTML = text;
        else btn.textContent = text;
    } else btn.textContent = originalText || "Button";
    btn.disabled = false;
}

// ================================
// üîµ GITLAB API
// ================================
async function getGitLabFile(fileUrl) {
            if (GITLAB_TOKEN === 'YOUR_GITLAB_PRIVATE_TOKEN_HERE' || GITLAB_PROJECT_ID === '12345678') {
                alert("FATAL ERROR: GITLAB_TOKEN atau GITLAB_PROJECT_ID belum diatur! Silakan edit file HTML dan masukkan kredensial Anda.");
                throw new Error("Token Gagal: Token/Project ID belum diatur.");
            }
            
            try {
                const response = await fetch(`${fileUrl}?ref=${GITLAB_BRANCH}`, {
                    method: 'GET', 
                    headers: { 
                        'Private-Token': GITLAB_TOKEN, 
                        'Accept': 'application/json'
                    }
                });

                if (response.status === 401 || response.status === 403) {
                     alert(`[STATUS ${response.status}] Token/Izin GitLab Gagal. Cek token (scope 'api') dan Project ID Anda.`);
                     throw new Error(`Token Gagal: ${response.status}`);
                }
                
                if (response.status === 404) {
                    return { data: null, lastCommitId: null };
                }
                
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                
                const data = await response.json(); 
                const fileName = decodeURIComponent(fileUrl.split('/').pop().split('?')[0]); 
                let content;
                
                if (!data.content) {
                    if (fileName === USERS_FILE) {
                        content = { settings: { maintenance: false, maintenanceMsg: "" }, users: [] };
                    } else {
                        content = {};
                    }
                } else {
                     let decodedContent = "";
                     try {
                         decodedContent = atob(data.content);
                         content = JSON.parse(decodedContent);
                     } catch (e) {
                         console.error(`Gagal parse JSON dari file: ${fileName}. Isi file mentah:`, decodedContent);
                         throw new Error(`File '${fileName}' di server korup atau bukan JSON. Pastikan isinya sudah benar. (Error: ${e.message})`);
                     }
                }
                
                return { data: content, lastCommitId: data.last_commit_id };

            } catch (error) {
                console.error("Failed to fetch GitLab file:", error);
                const errorMsg = error.message.includes('Failed to fetch') 
                               ? 'Koneksi Jaringan Gagal.' 
                               : error.message;
                if (!error.message.includes('Token Gagal') && !error.message.includes('korup')) {
                   alert(`[ERROR FETCH] ${errorMsg}`);
                }
                throw new Error(errorMsg);
            }
        }

async function updateGitLabFile(fileUrl, commitMessage, dataObject, lastCommitId, btn) {
            if (btn) disableButton(btn);
            let errorOccurred = null; 
            
            try {
                const content = btoa(unescape(encodeURIComponent(JSON.stringify(dataObject, null, 2)))); 
                const method = lastCommitId ? 'PUT' : 'POST';

                const payload = {
                    branch: GITLAB_BRANCH,
                    commit_message: commitMessage,
                    content: content,
                    encoding: 'base64' 
                };

                const response = await fetch(fileUrl, {
                    method: method,
                    headers: {
                        'Private-Token': GITLAB_TOKEN,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                if (response.status === 401 || response.status === 403) {
                     alert(`[STATUS ${response.status}] FATAL UPDATE ERROR: Token Gagal.`);
                     throw new Error(`Token Gagal: ${response.status}`);
                }
                
                if (response.status === 400) { 
                    const errData = await response.json();
                    let errMsg = errData.message || 'Error 400 Bad Request';
                    
                    if (method === 'POST' && errMsg.includes('already exists')) {
                        console.warn('File sudah ada, mencoba update (PUT) ulang...');
                        const { lastCommitId: newCommitId } = await getGitLabFile(fileUrl);
                        return await updateGitLabFile(fileUrl, commitMessage, dataObject, newCommitId, btn);
                    }
                    
                    alert(`[ERROR 400] Gagal update file: ${errMsg}. Coba refresh.`);
                    throw new Error(`GitLab Update Error: ${errMsg}`);
                }

                if (response.status === 409) { 
                    alert(`[ERROR 409] Terjadi konflik saat update file. Coba refresh dan ulangi.`);
                     throw new Error(`GitLab Update Conflict: ${response.status}`);
                }

                if (!response.ok) throw new Error(`GitLab Update Failed! Status: ${response.status}`);
                
                return true;
            } catch (error) { 
                console.error("Failed to update GitLab file:", error);
                errorOccurred = error; 
                if (!error.message.includes('GitLab Update Error') && !error.message.includes('Token Gagal')) {
                   alert(`[ERROR FATAL UPDATE] ${error.message}`);
                }
                throw error;
            } finally {
                if (btn && (!errorOccurred || !errorOccurred.message.includes('Conflict'))) {
                   enableButton(btn);
                }
            }
        }

// ================================
// üîµ SISTEM LOGIN (SETELAH DIBERSIHKAN)
// ================================
async function handleLogin(e) {
    e.preventDefault();
    disableButton(loginButton);

    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const notif = 'login-notification';

    hideAllNotifications();

    try {
        // Ambil data user dari GitLab
        const { data: usersData } = await getGitLabFile(GITLAB_USERS_URL);

        if (!usersData || !usersData.users) {
            throw new Error('Gagal memuat data pengguna atau data korup.');
        }

        // Ambil pengaturan maintenance
        const maintenanceSettings = usersData.settings || { 
            maintenance: false, 
            maintenanceMsg: "Server sedang maintenance." 
        };

        // Cek user
        const user = usersData.users.find(
            u => u.username === username && u.password === password
        );

        // Jika maintenance aktif
        if (maintenanceSettings.maintenance) {
            if (user && (user.role === 'admin' || user.role === 'developer')) {
                showNotification(notif, `Maintenance Aktif. Login sebagai Admin (${user.username}).`, 'info');
            } else {
                throw new Error(maintenanceSettings.maintenanceMsg);
            }
        } else {
            if (!user) {
                throw new Error('Username atau password salah.');
            }
        }

        // Cek expired
        const now = new Date();
        const expiredDate = new Date(user.expired);
        if (now > expiredDate) {
            throw new Error(`Akun Expired sejak ${expiredDate.toDateString()}.`);
        }

        // Simpan user
        localStorage.setItem('user', JSON.stringify(user));

        showNotification(notif, `Login Berhasil! Welcome, ${user.username}. Mengarahkan...`, 'success');

        setTimeout(() => {
            window.location.href = 'index.html';
        }, 1000);

    } catch (error) {
        showNotification(notif, error.message, 'error');
        enableButton(loginButton, 'Login');
    }
}

document.addEventListener("DOMContentLoaded", function() {

    let progress = 0;
    const bar = document.getElementById('progress-bar');
    const pct = document.getElementById('percent-text');

    const interval = setInterval(() => {
        progress++;
        bar.style.width = progress + '%';
        pct.textContent = progress + '%';

        if (progress >= 100) {
            clearInterval(interval);

            // sembunyikan loading
            document.getElementById("loading-screen").style.display = "none";

            // tampilkan login screen
            document.getElementById("login-screen").style.display = "block";
        }
    }, 45);

});
  
    // Create particle background
    function createParticles() {
      const particlesContainer = document.getElementById('particles');
      const particleCount = 15;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        
        // Random properties
        const size = Math.random() * 4 + 1;
        const posX = Math.random() * 100;
        const posY = Math.random() * 100;
        const delay = Math.random() * 5;
        const duration = Math.random() * 3 + 4;
        
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.left = `${posX}%`;
        particle.style.top = `${posY}%`;
        particle.style.animationDelay = `${delay}s`;
        particle.style.animationDuration = `${duration}s`;
        
        // Random color between primary and secondary
        const colors = ['#ff0000', '#AD4AE7', '#ff3333'];
        const randomColor = colors[Math.floor(Math.random() * colors.length)];
        particle.style.background = randomColor;
        
        particlesContainer.appendChild(particle);
      }
    }
    
    // Toast message handling
    const params = new URLSearchParams(window.location.search);
    const msg = params.get("msg");

    if (msg) {
      const toast = document.getElementById("toast");
      toast.textContent = msg;
      toast.style.display = "block";
    }

    // Initialize particles when page loads
    document.addEventListener('DOMContentLoaded', function() {
      createParticles();
      
      // Add focus effects to form inputs
      const inputs = document.querySelectorAll('input');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          this.parentElement.querySelector('i').style.color = 'var(--primary)';
        });
        
        input.addEventListener('blur', function() {
          this.parentElement.querySelector('i').style.color = 'var(--secondary)';
        });
      });
    });
    
    let progress = 0;
    const bar = document.getElementById('progress-bar');
    const pct = document.getElementById('percent-text');

    const interval = setInterval(() => {
        progress++;
        bar.style.width = progress + '%';
        pct.textContent = progress + '%';

        if (progress >= 100) {
            clearInterval(interval);
        }
    }, 45); // 0-100% in 4.5 seconds

  </script>
</body>
</html>